(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-467cf0e0"],{"33f7":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("GenericDetailPage",t._g(t._b({attrs:{object:t.ticket,"active-menu":t.config.activeMenu},on:{"update:object":function(e){t.ticket=e},"update:activeMenu":function(e){return t.$set(t.config,"activeMenu",e)},"update:active-menu":function(e){return t.$set(t.config,"activeMenu",e)}}},"GenericDetailPage",t.config,!1),t.$listeners),[a(t.config.activeMenu,{tag:"component",attrs:{object:t.ticket}})],1)},s=[],c=a("cd4a"),n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("GenericTicketDetail",{attrs:{object:t.object,"detail-card-items":t.detailCardItems,"special-card-items":t.specialCardItems,"assigned-card-items":t.assignedCardItems,approve:t.handleApprove,close:t.handleClose,reject:t.handleReject}})},o=[],r=(a("57e7"),a("ed08")),p=a("cf45"),u=a("0218"),l=a("9cdc"),m={name:"",components:{GenericTicketDetail:l["a"]},props:{object:{type:Object,default:function(){return{}}}},data:function(){return{statusMap:"open"===this.object.status?u["b"]["notified"]:u["b"][this.object.state],requestForm:{name:this.object.meta.approve_permission_name,application:this.object.meta["apply_applications"],systemuser:this.object.meta["apply_system_users"],apply_date_expired:this.object.meta.apply_date_expired,apply_date_start:this.object.meta.apply_date_start},comments:"",assets:[]}},computed:{detailCardItems:function(){var t=this,e=this.$createElement;return[{key:this.$t("tickets.status"),value:this.object.status,formatter:function(a,i){return e("el-tag",{attrs:{type:t.statusMap.type,size:"mini"}},[" ",t.statusMap.title])}},{key:this.$t("tickets.type"),value:this.object.type_display},{key:this.$t("tickets.user"),value:this.object["applicant_display"]},{key:this.$t("tickets.OrgName"),value:this.object["org_name"]},{key:this.$t("common.dateCreated"),value:Object(p["p"])(this.object.date_created)},{key:this.$t("common.Comment"),value:this.object.comment}]},specialCardItems:function(){return[{key:this.$t("applications.appType"),value:"".concat(this.object.meta["apply_category_display"]," / ").concat(this.object.meta["apply_type_display"]," ")},{key:this.$t("applications.appName"),value:this.object.meta.apply_applications_display.join(", ")},{key:this.$t("tickets.SystemUser"),value:this.object.meta.apply_system_users_display.join(", ")},{key:this.$t("common.dateStart"),value:Object(p["p"])(this.object.meta.apply_date_start)},{key:this.$t("common.dateExpired"),value:Object(p["p"])(this.object.meta.apply_date_expired)}]},assignedCardItems:function(){var t=this.$createElement,e=this;return[{key:this.$t("tickets.PermissionName"),value:this.object.meta.apply_permission_name,formatter:function(a,i){var s={name:"ApplicationPermissionDetail",params:{id:e.object.id},query:{oid:e.object.org_id}};return"closed"===e.object.status&&"approved"===e.object.state?t("router-link",{attrs:{to:s}},[i]):t("span",[i])}},{key:this.$t("applications.appName"),value:this.object.meta.apply_applications_display.join(", ")},{key:this.$t("tickets.SystemUser"),value:this.object.meta.apply_system_users_display.join(", ")},{key:this.$t("common.dateStart"),value:Object(p["p"])(this.object.meta.apply_date_start)},{key:this.$t("common.dateExpired"),value:Object(p["p"])(this.object.meta.apply_date_expired)}]},hasActionPerm:function(){return-1!==this.object.assignees.indexOf(this.$store.state.users.profile.id)}},methods:{formatTime:function(t){return Object(r["a"])(Object(r["b"])(t))},toSafeLocalDateStr:function(t){return Object(p["p"])(t)},reloadPage:function(){window.location.reload()},handleApprove:function(){var t=this;if(0===this.requestForm.application.length||0===this.requestForm.systemuser.length)return this.$message.error(this.$tc("common.NeedAssetsAndSystemUserErrMsg"));this.$axios.put("/api/v1/tickets/tickets/".concat(this.object.id,"/approve/"),{meta:{}}).then((function(){t.$message.success(t.$tc("common.updateSuccessMsg")),t.reloadPage()})).catch((function(){return t.$message.success(t.$tc("common.updateErrorMsg"))}))},handleClose:function(){var t=this,e="/api/v1/tickets/tickets/".concat(this.object.id,"/close/");this.$axios.put(e).then((function(e){return t.reloadPage()})).catch((function(e){return t.$message.error(e)}))},handleReject:function(){var t=this,e="/api/v1/tickets/tickets/".concat(this.object.id,"/reject/");this.$axios.put(e).then((function(e){return t.reloadPage()})).catch((function(e){return t.$message.error(e)}))}}},d=m,h=(a("9b4b"),a("2877")),b=Object(h["a"])(d,n,o,!1,null,"581a5dd7",null),y=b.exports,j={components:{GenericDetailPage:c["e"],TicketDetail:y,TabPage:c["m"]},data:function(){return{ticket:{title:"",user_display:"",type_display:"",status:"",assignees_display:"",date_created:""},config:{activeMenu:"TicketDetail",url:"",submenu:[{title:this.$t("route.TicketDetail"),name:"TicketDetail"}],actions:{detailApiUrl:"/api/v1/tickets/tickets/".concat(this.$route.params.id,"/")},getObjectName:this.getObjectName,hasRightSide:!1}}},mounted:function(){},methods:{getObjectName:function(){return this.ticket.title}}},f=j,_=Object(h["a"])(f,i,s,!1,null,"7d27ab33",null);e["default"]=_.exports},7578:function(t,e,a){},"9b4b":function(t,e,a){"use strict";var i=a("7578"),s=a.n(i);s.a}}]);